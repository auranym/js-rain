class RainBackground extends HTMLElement{static observedAttributes=['color1','color2'];color1;color2;shadowRoot;rainCanvas;rainCtx;droplets;prevTimestamp;newDropletTimeoutRemaining;constructor(){super();this.color1=this.color2='#000';this.droplets=[];this.prevTimestamp=-1;this.newDropletTimeoutRemaining=0;this.shadowRoot=this.attachShadow({mode:'open'});this.shadowRoot.innerHTML=`
      <canvas
        style="position: fixed; top: 0; left: 0"
        aria-hidden="true"
        role="presentation">
      </canvas>
    `;let a=this.shadowRoot.querySelector('canvas');if(!a?.getContext){console.error('rain-background: Could not find canvas.');return}this.rainCanvas=a;a=this.rainCanvas.getContext('2d');if(!a){console.error('rain-background: Could not get canvas context.');return}this.rainCtx=a;this.setCanvasSize(window.innerWidth,window.innerHeight);window.onresize=(A=>{let b;return function B(..._){clearTimeout(b);b=setTimeout((()=>{clearTimeout(b);A(..._)}),100)}})(()=>this.setCanvasSize(window.innerWidth,window.innerHeight));window.requestAnimationFrame(this.drawDroplets.bind(this))}attributeChangedCallback(c,C,_c){if(c==='color1')this.color1=_c;else c==='color2'&&(this.color2=_c)}drawDroplets(_a){this.prevTimestamp===-1&&(this.prevTimestamp=_a);var _b=_a-this.prevTimestamp;this.rainCtx.clearRect(0,0,window.innerWidth,window.innerHeight);this.droplets=this.droplets.reduce((D,_B)=>{if(_B.y>=window.innerHeight)return D;_B.y+=_b*this.getDropletSpeed();D.push(_B);return D},[]);this.newDropletTimeoutRemaining<=0?(this.droplets.push(this.getDroplet()),this.newDropletTimeoutRemaining=this.getNewDropletTimeout()):(this.newDropletTimeoutRemaining-=_b);var d=this.getDropletLength();for(const droplet of this.droplets){this.rainCtx.fillStyle=droplet.color;this.rainCtx.beginPath();this.rainCtx.roundRect(Math.round(droplet.x),Math.round(droplet.y),4,d,4);this.rainCtx.fill()}this.prevTimestamp=_a;window.requestAnimationFrame(this.drawDroplets.bind(this))}getDroplet(){var _A=this.getDropletLength();return{x:window.innerWidth*Math.random(),y:(_A/2.0)*Math.random()-_A/2.0,color:[this.color1,this.color2][~~Math.random()*2]}}getDropletLength(){return Math.ceil(window.innerHeight/2)}getDropletSpeed(){return Math.ceil(window.innerHeight/250)}getNewDropletTimeout(){return Math.ceil(15000/window.innerWidth)}setCanvasSize(e,E){this.rainCanvas.setAttribute('width',`${e}px`);this.rainCanvas.setAttribute('height',`${E}px`)}}customElements.define('rain-background',RainBackground);
